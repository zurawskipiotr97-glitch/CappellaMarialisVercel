<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cappella Marialis</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- TREŚĆ STRONY (skrócona – u Ciebie zostaje całość) -->

<a href="https://id.ffm.to/penderdcki_academy_press_-_msza_es-dur"
   class="open-recording-modal"
   data-modal-url="https://id.ffm.to/penderdcki_academy_press_-_msza_es-dur">
   Listen online
</a>

<!-- MODAL -->
<div id="recording-modal" class="recording-modal" aria-hidden="true" role="dialog" aria-modal="true">
  <button class="recording-modal__overlay" aria-label="Zamknij"></button>
  <div class="recording-modal__content" role="document">
    <button class="recording-modal__close" aria-label="Zamknij">×</button>
    <iframe id="recording-modal-iframe"
      loading="lazy"
      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
      title="Odtwarzacz nagrania"></iframe>
  </div>
</div>

<script>
(function () {
  const modal = document.getElementById("recording-modal");
  const iframe = document.getElementById("recording-modal-iframe");
  if (!modal || !iframe) return;

  const overlayBtn = modal.querySelector(".recording-modal__overlay");
  const closeBtn = modal.querySelector(".recording-modal__close");

  let lastActiveEl = null;
  let prevBodyOverflow = "";

  function openModal(url) {
    if (!url) return;
    lastActiveEl = document.activeElement;
    prevBodyOverflow = document.body.style.overflow;

    modal.classList.add("is-open");
    modal.setAttribute("aria-hidden", "false");
    document.body.style.overflow = "hidden";
    iframe.src = url;
    closeBtn && closeBtn.focus();
  }

  function closeModal() {
    modal.classList.remove("is-open");
    modal.setAttribute("aria-hidden", "true");
    iframe.src = "about:blank";
    document.body.style.overflow = prevBodyOverflow || "";
    lastActiveEl && lastActiveEl.focus();
  }

  document.addEventListener("click", e => {
    const trigger = e.target.closest(".open-recording-modal");
    if (!trigger) return;
    e.preventDefault();
    openModal(trigger.dataset.modalUrl || trigger.href);
  });

  overlayBtn && overlayBtn.addEventListener("click", closeModal);
  closeBtn && closeBtn.addEventListener("click", closeModal);

  document.addEventListener("keydown", e => {
    if (e.key === "Escape" && modal.classList.contains("is-open")) closeModal();
  });
})();
</script>

</body>
</html>
