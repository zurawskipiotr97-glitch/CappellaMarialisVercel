<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Cappella Marialis</title>
  <meta name="description" content="Cappella Marialis is a vocal ensemble of St. Mary&#x27;s Basilica in KrakÃ³w. Concerts, recordings and news." />

  <link rel="canonical" href="https://www.cappellamarialis.pl/en.html" />
  <link rel="alternate" hreflang="en" href="https://www.cappellamarialis.pl/en.html" />
  <link rel="alternate" hreflang="pl" href="https://www.cappellamarialis.pl/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Cappella Marialis" />
  <meta property="fb:app_id" content="1519385729118488" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:url" content="https://www.cappellamarialis.pl/en.html" />
  <meta property="og:title" content="Cappella Marialis" />
  <meta property="og:description" content="Vocal ensemble of St. Mary&#x27;s Basilica in KrakÃ³w. Concerts, recordings and news." />
  <meta property="og:image" content="https://www.cappellamarialis.pl/images/og-cover-1200x630.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Cappella Marialis â€“ zespÃ³Å‚ wokalny" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Cappella Marialis" />
  <meta name="twitter:description" content="Vocal ensemble of St. Mary&#x27;s Basilica in KrakÃ³w. Concerts, recordings and news." />
  <meta name="twitter:image" content="https://www.cappellamarialis.pl/images/og-cover-1200x630.jpg" />

  <link rel="stylesheet" href="style.css" />

  <link rel="icon" href="/favicon.ico" sizes="any" />
  <link rel="icon" type="image/png" href="/favicon-48.png" sizes="48x48" />
  <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="/images/android-chrome-192x192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" sizes="180x180" />

  <link rel="manifest" href="/site.webmanifest" />
  <meta name="theme-color" content="#0f3460" />
</head>


<body>
        
<a href="#main-content" class="skip-link">Skip to content</a>

   <h1 class="visually-hidden">Cappella Marialis</h1>

    <!-- Facebook plugin -->
     <div id="fb-root"></div>
<script async defer crossorigin="anonymous"
        src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v24.0&appId=1519385729118488">
</script>


    <!-- HEADER -->
    <header>
        <div class="header-logo">
            <a href="en.html">
                <img src="images/CM_logo.png" alt="Cappella Marialis Logo">
            </a>
        </div>
        
        <div class="lang-switcher">
            <a href="index.html" class="lang">PL</a>
            <span class="separator">|</span>
            <a href="en.html" class="lang">EN</a>
        </div>
    </header>

    <!-- NAVIGATION -->
    <nav aria-label="Main navigation">
        <ul>
            <li><a href="#zespol">ABOUT US</a></li>
            <li><a href="#wesprzyj">SUPPORT US</a></li>
            <li><a href="#aktualnosci">NEWS</a></li>
            <li><a href="#posluchaj">LISTEN US</a></li>
            <li><a href="#dane">CONTACT</a></li>
        </ul>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="container" id="main-content">
        
        <!-- ZESPÃ“Å -->
        <section id="zespol">
            <h2>ABOUT US</h2>
            
            <div class="team-intro">
                <img src="images/CM_zdjecie.jpg" alt="Cappella Marialis ensemble" class="team-image">
                
                <div class="team-short text-unified">
                    <p> <strong>CAPPELLA MARIALIS</strong> - Vocal ensemble, composed of professional singers, 
                        was revived in 2017 after an absence of over 150 years. Its activities draw on the centuries-old musical tradition of St. Mary's Church in Krakow.
                         The ensemble can be heard in St. Mary's Basilica on Sundays during the 12:00&nbsp;PM Mass, as well as during other liturgical celebrations.</p>
                <button class="expand-btn" onclick="toggleTeam(this)" aria-controls="teamFull" aria-expanded="false" data-team-toggle="teamFull">Read more</button>
                </div>
            </div>
            
            <!-- <button class="expand-btn" onclick="toggleTeam()">Czytaj wiÄ™cej</button> -->
            
            <div class="team-full" id="teamFull">
                
                <div class="long text-unified">

                    <p style="text-indent: 0;">
                        <strong>CAPPELLA MARIALIS</strong>
                    </p>

                    <p style="text-wrap: pretty; text-indent: 0;">
                        The vocal ensemble, made up of professional singers, was reactivated in 2017 after over 150 years of absence.
                    </p>

                    <p style="text-wrap: pretty; text-indent: 0;">
                        In its activities, it draws on the centuries-old musical tradition of St. Mary's Church in Krakow.
                        The ensemble's repertoire consists of liturgical music â€“ from Gregorian chant to works by contemporary composers.
                        The singers most often perform the music a cappella, sometimes also accompanied by organ and orchestra.
                    </p>

                    <p style="text-wrap: pretty; text-indent: 0;">
                        The primary goal of Cappella Marialis is to promote valuable Polish music during liturgies and concerts.
                        In 2018, the artists embarked on two concert tours across Western Europe, presenting works by Polish composers to international audiences.
                    </p>

                    <p style="text-wrap: pretty; text-indent: 0;">
                        Together with the Symphony Orchestra of the Sanctuary of Divine Mercy in Krakow, they participated in the opening of the Polish chapel 
                        at the Cathedral of Notre Dame in Paris, singing during the ceremonial liturgy. They also gave a concert of music by K. Szymanowski, 
                        H. M. GÃ³recki, K. Penderecki, and H. J. Botor. The ensemble also performed at the Church of St. Paul in Berlin.
                    </p>

                    <p style="text-wrap: pretty; text-indent: 0;">
                        Cappella Marialis participates in music festivals in Poland, representing St. Mary's Basilica and its rich musical traditions. 
                        The ensemble can be heard in St. Mary's Basilica on Sundays during the 12:00&nbsp;PM Mass, as well as during other solemn liturgies.
                    </p>

                    <p style="text-wrap: pretty; text-indent: 0;">
                        In 2019, the ensemble recorded its first CD of Polish sacred music.

                        In <em>2025</em>, it produced an audiovisual recording of Franciszek Mirecki's Mass in E-flat Major,

                        with the participation of outstanding soloists: Sylwia OlszyÅ„ska, Ewa Wolak, Andrzej Lampert, Marcin Wolak, and Daniel Prajzner.
                    </p>

                    <p style="text-indent: 0;">
                        The founder and conductor of the ensemble is dr hab.&nbsp;Krzysztof MichaÅ‚ek, prof.&nbsp;AMKP.
                    </p>

                </div>

                <!-- <h3 style="text-align: left;">ðŸ‘¤ Kierownictwo artystyczne</h3> -->
                <h3 style="text-align: left;">Artistic direction</h3>
                <p><strong>Conductor:</strong> dr&nbsp;hab.&nbsp;Krzysztof MichaÅ‚ek, prof.&nbsp;AMKP</p>

                <!-- <h3>ðŸ“§ Kontakt</h3> -->
                <h3>Contact</h3>
                <p>Email: <strong>cappellamarialis@gmail.com</strong></p>
                
                <button class="expand-btn" onclick="toggleTeam(this)" aria-controls="teamFull" aria-expanded="false" data-team-toggle="teamFull">Collapse</button>
            </div>
        </section>

        <!-- WESPRZYJ NAS -->
        <section id="wesprzyj">
            <h2 style="margin-bottom: 0.5rem;">SUPPORT US</h2>
            <p class="text-unified">We invite you to support our work. Your donations enable us to organize concerts, 
                record music, and promote Polish sacred music both at home and abroad.</p>
            
            <div class="donation-box">
                <h3 style="color:#d4af37; margin-top: -1.5rem; margin-bottom: 0.5rem;">Your support matters</h3>
                <p class="text-unified" style="margin-bottom: 1.5rem;">Thank you for all your help in achieving our mission</p>
                
                <div class="donation-details" style="text-align: center; margin-top: 1rem;">

                    <div class="block-display">
                        <p><strong>Recipient:</strong></p>
                        <p>Foundation Cappella Marialis</p>
                    </div>
                    
                    <div class="block-display">
                        <p><strong>Account number:</strong></p>
                        <p>42&nbsp;1240&nbsp;5080&nbsp;1111&nbsp;0011&nbsp;4413&nbsp;1593</p>
                    </div>
                    
                    <div class="block-display">
                        <p><strong>Transfer title:</strong></p>
                        <p>Darowizna&nbsp;-&nbsp;Cappella&nbsp;Marialis</p>
                    </div>

                    <div class="block-display" style="margin-bottom: 0rem;">
                        <p><strong>Email:</strong></p>
                        <p>cappellamarialis@gmail.com</p>
                    </div>
                </div>
                
                <button class="donate-btn" type="button" onclick="showDonationInfo()">Support Us</button>
                <p id="donationStatus" class="visually-hidden" role="status" aria-live="polite">Thank you for your willingness to support our activities. We are currently working on implementing additional payment methods. Until then, please make a bank transfer to the account number provided below. If you have any questions or encounter any issues, please contact us by email.</p>

            
                </br>
                <label class="rodo-label" for="consent-info">
                <input id="consent-info" type="checkbox" required>
                I declare that I have read the information clause
                <a href="rodo.html" class="album-link" target="_blank" rel="noopener noreferrer">GDPR</a>  
                and
                <a href="privacy.html" class="album-link" target="_blank" rel="noopener noreferrer">Privacy Policy</a>.
                </label>
            
            </div>
        </section>


        <!-- AKTUALNOÅšCI -->
        <section id="aktualnosci">
            <h2>NEWS</h2>

            <div id="fb-news"></div>
           
    <div class="fb-section">

        <div class="fb-header">
           <div class="fb-header-container">
                <!-- <img class="fb-stub" src="images/mariacki_short_id.jpg" images> -->
                <a href="https://www.facebook.com/CappellaMarialis"
                    target="_blank"
                    rel="noopener noreferrer">
                      <img class="fb-stub" src="images/mariacki_short_id2.jpg"
                        src="images/mariacki_short_id2.jpg"
                        alt="Cappella Marialis profile on Facebook">           
                </a>
            </div>

            <div class="fb-header-facebook">
                <a href="https://www.facebook.com/CappellaMarialis"
                    target="_blank"
                    rel="noopener noreferrer"
                    style="text-decoration:none;color:inherit;">
                    <span class="fb-text">facebook</span>
                        <p class="fb-note">
                            Official profile of Cappella Marialis
                        </p>
                </a>
            </div>        
        </div>


        <p class="fb-description">
            Concert announcements, event reports, and behind-the-scenes photos. Stay up-to-date with our events!
        </p>

        <a href="https://www.facebook.com/CappellaMarialis"
        target="_blank" rel="noopener noreferrer"
        class="fb-cta">
            Visit us on Facebook
        </a>
    </div>


            
    </section>
       <section id="posluchaj">
    <h2>LISTEN US</h2>
    
    <div>
        <img class="image-listen-us" src="images/CM_news.jpg" alt="Cappella Marialis concert">
    </div>

    <div class="listen-layout">
        <div class="listen-media">

        <div class="player-block player-youtube">
            <div class="player-header">
                <a href="https://www.youtube.com/@cappellamarialis8791"
                target="_blank" rel="noopener noreferrer"
                class="brand-logo-link"
                aria-label="KanaÅ‚ Cappella Marialis na YouTube">
                    <img src="images/youtube-logo-icon.svg"
                        alt="YouTube"
                        class="brand-logo">
                </a>
            </div>

        <div class="player-embed">
            <iframe
                            src="https://www.youtube.com/embed/videoseries?list=PLURFuN4b77fupcE-qOdmAHdOC54uKiF3t"
                            title="Cappella Marialis â€“ YouTube playlist"
                            frameborder="0"
                            height="360"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            allowfullscreen
                            loading="lazy">
                        </iframe>
        </div>

        <div class="player-footer">
            <a href="https://www.youtube.com/@cappellamarialis8791"
            target="_blank" rel="noopener noreferrer"
            class="player-cta player-cta-youtube">
                Visit us on YouTube
            </a>
        </div>
</div>



<div class="player-block player-spotify">
    <div class="player-header">
        <a href="https://open.spotify.com/album/0jaKaj1nfsDEEikiDxb3Qk"
           target="_blank" rel="noopener noreferrer"
           class="brand-logo-link"
           aria-label="PrzykÅ‚adowy album chÃ³ralny w Spotify">
            <img src="images/spotify-logo.png"
                 alt="Spotify"
                 class="brand-logo">
        </a>
    </div>

    <div class="player-embed spotify-embed">
        <iframe style="border-radius:12px"
            src="https://open.spotify.com/embed/album/0jaKaj1nfsDEEikiDxb3Qk?utm_source=generator&theme=0"
            width="100%"
            height=152
            frameborder="0"
            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
            loading="lazy"
            title="Spotify Player â€“ Cappella Marialis">
        </iframe>
    </div>

    <div class="player-footer">
        <a href="https://open.spotify.com/album/0jaKaj1nfsDEEikiDxb3Qk"
        target="_blank" rel="noopener noreferrer"
        class="player-cta player-cta-spotify">
            Play on Spotify
        </a>
    </div>
</div>


</div>

     <!-- RECORDINGS -->
<div class="albums-block">
  <h3 class="album-header">RECORDINGS</h3>

  <div class="album-tabs" role="tablist" aria-label="CD albums">
    <button class="album-tab is-active" type="button" role="tab"
            aria-selected="true" aria-controls="album-msza-esdur-en" id="tab-msza-esdur-en"
            data-target="album-msza-esdur-en"
            style="font-size: 80%;">
      Mass in E flat major
    </button>

    <button class="album-tab" type="button" role="tab"
            aria-selected="false" aria-controls="album-cm-2019-en" id="tab-cm-2019-en"
            data-target="album-cm-2019-en"
            style="font-size: 80%;">
      Cappella Marialis
    </button>
  </div>

  <div class="album-panels">
    <div class="album-panel is-active" role="tabpanel"
         id="album-msza-esdur-en" aria-labelledby="tab-msza-esdur-en">
      <div class="album-card">
        <div class="album-cover">
          <a href="https://id.ffm.to/penderdcki_academy_press_-_msza_es-dur" class="album-cover-link open-recording-modal" data-modal-url="https://id.ffm.to/penderdcki_academy_press_-_msza_es-dur" aria-label="Listen to us">
                      <img src="images/CM_Mirecki_frontcover.png"
               onerror="this.src='images/CM_news.jpg';"
               alt="Album cover: Mass in E flat major â€“ Franciszek Mirecki">
                      <span class="album-cover-overlay"><span>Listen to us</span></span>
                    </a>
                    </div>

        <div class="album-info">
          <p class="album-title">Mass in E flat major</p>
                    
                    </p>
          <p class="album-subtitle">
            Franciszek Mirecki (1791â€“1862) â€“<br>audiovisual recording (2025)
          </p>
          <a href="https://id.ffm.to/penderdcki_academy_press_-_msza_es-dur" class="album-link open-recording-modal" data-modal-url="https://id.ffm.to/penderdcki_academy_press_-_msza_es-dur">
                      Listen online
                    </a>

          <!-- optional back cover -->
          <!-- <a href="images/CM_Mirecki_backcover.png" target="_blank" rel="noopener noreferrer" class="album-link">
            See back cover and tracklist
          </a> -->
        </div>
      </div>
    </div>

    <div class="album-panel" role="tabpanel"
         id="album-cm-2019-en" aria-labelledby="tab-cm-2019-en">
      <div class="album-card">
        <div class="album-cover">
          <img src="images/CM_CM_frontcover.png"
               onerror="this.src='images/CM_news.jpg';"
               alt="Album cover: Cappella Marialis">
        </div>

        <div class="album-info">
          <p class="album-title">Cappella Marialis</p>
          <p class="album-subtitle">
            The vocal ensemble of St.&nbsp;Mary's Basilica in Krakow
          </p>
          <a href="images/CM_CM_backcover.png" target="_blank" rel="noopener noreferrer" class="album-link">
            See back cover and tracklist
          </a>
        </div>
      </div>
    </div>
  </div>

  <p class="album-note text-unified">
    CDs are available at St.&nbsp;Mary's Basilica after selected masses and concerts.
  </p>
</div>


</section>


        <!-- CONTACT -->
        <section id="dane" style="margin-bottom: 0rem;">
            <h2 style="margin-bottom: 0.5rem;">CONTACT</h2>

            <div class="contact-box">
                <p><span>Name of the Foundation:</span> Cappella Marialis</p>
                <p><span>NIP:</span> 6832140625</p>
                <p><span>Address:</span> BodzanÃ³w&nbsp;393, 32-020&nbsp;BodzanÃ³w</p>
                <p style="margin-bottom: 0;"><span>E-mail:</span> cappellamarialis@gmail.com</p>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer>
        <p style="color: #d4af37"><strong>Cappella Marialis</strong></p>
            <a href="accessibility.html" class="album-link" style="margin-right: 5px;">Accessibility statement</a>
<a href="regulamin.html" class="album-link" style="margin-right: 5px;"> Sale Rules (PL)</a>
        <a href="rodo.html" class="album-link" style="margin-right: 5px;"> GDPR Clause </a>
        <a href="privacy.html" class="album-link"> Privacy Policy </a>
        <p class="copyright" >Â© 2025 Cappella Marialis. All rights reserved.</p>
    </footer>

    <script>
        function toggleTeam(btn) {
            const panelId = (btn && btn.getAttribute && btn.getAttribute('aria-controls')) || 'teamFull';
            const teamFull = document.getElementById(panelId);
            if (!teamFull) return;

            const willExpand = !teamFull.classList.contains('active');
            teamFull.classList.toggle('active', willExpand);

            // aria-expanded on all related toggles
            document.querySelectorAll('[data-team-toggle="' + panelId + '"]').forEach(b => {
                b.setAttribute('aria-expanded', String(willExpand));
            });

            // Smooth scroll when expanding
            if (willExpand) {
                setTimeout(() => {
                    teamFull.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            } else if (btn && typeof btn.focus === 'function') {
                // return focus to the trigger if collapsing from inside the panel
                btn.focus();
            }
        }

        // Smooth scroll dla nawigacji
        document.querySelectorAll('nav a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({ behavior: (window.matchMedia('(prefers-reduced-motion: reduce)').matches ? 'auto' : 'smooth'), block: 'start' });
                }
            });
        });
    </script>

    <script>
  function initAlbumTabs() {
    document.querySelectorAll('.albums-block').forEach(block => {
      const tabs = block.querySelectorAll('.album-tab');
      const panels = block.querySelectorAll('.album-panel');

      if (!tabs.length || !panels.length) return;

      function activate(targetId) {
        tabs.forEach(t => {
          const isActive = t.dataset.target === targetId;
          t.classList.toggle('is-active', isActive);
          t.setAttribute('aria-selected', isActive ? 'true' : 'false');
        });

        panels.forEach(p => {
          p.classList.toggle('is-active', p.id === targetId);
        });
      }

      tabs.forEach(t => {
        t.addEventListener('click', () => activate(t.dataset.target));
      });

      // DomyÅ›lnie: najnowszy = pierwszy tab (czyli pierwszy w HTML)
      activate(tabs[0].dataset.target);
    });
  }

  window.addEventListener('DOMContentLoaded', initAlbumTabs);
</script>


<script>
    // jeÅ›li bÄ™dzie tekst angielski to trzeba inne reguÅ‚y i troszkÄ™ przerobiÄ‡
    function applyHardSpaces(text) {
        if (!text) return text;

        // Jednoliterowe przyimki/spÃ³jniki (PL) + podstawowe (EN)
        text = text.replace(/(^|\s)([aiouwzAIUOWZ])(\s+)/g, '$1$2&nbsp;');
        text = text.replace(/(^|\s)(to|of|in|on|at)(\s+)/gi, '$1$2&nbsp;');

        // SkrÃ³ty
        text = text.replace(/\b(dr|hab|prof|Å›w|m\.in)\.\s+/gi, '$1.&nbsp;');

        // Liczby + wybrane jednostki/sÅ‚owa
        text = text.replace(/(\d)\s+(rok(u|ach)?|lat(a|ach)?|years?|pm|am)/gi, '$1&nbsp;$2');

        // MyÅ›lnik opisowy
        text = text.replace(/\sâ€“\s/g, ' â€“&nbsp;');

        return text;
    }
    
    async function loadFacebookNews() {
        const container = document.getElementById('fb-news');
        if (!container) return;

        try {
            const response = await fetch('/api/facebook-news?lang=en');
            const data = await response.json();

            // Backend zwraca albo tablicÄ™, albo obiekt { posts: [...] }
            const posts = Array.isArray(data) ? data : (data.posts || []);

            // NIC nie ograniczamy â€” liczba postÃ³w jest w config.php
            posts.forEach(post => {
                const item = document.createElement('div');
                item.className = 'news-item';

                // Format daty
                let dateText = '';
                if (post.date) {
                    const d = new Date(post.date);
                    dateText = `${String(d.getDate()).padStart(2,'0')}-${String(d.getMonth()+1).padStart(2,'0')}-${d.getFullYear()}`;
                }

                // Obrazek, jeÅ›li jest
                const imgHtml = post.image ? `<img src="${post.image}" alt="">` : '';

                // Ucinanie tekstu (Å¼eby wyglÄ…daÅ‚o jak dawniej)
                const rawBody = applyHardSpaces(
                    (post.body || '').replace(/\s+/g, ' ').trim()
                );
                const maxLength = 260; 
                const shortBody = rawBody.length > maxLength
                    ? rawBody.slice(0, maxLength).trim() + 'â€¦'
                    : rawBody;

                const linkButton = post.link
                    ? `<a href="${post.link}" target="_blank" rel="noopener noreferrer" class="fb-cta">View on Facebook</a>`
                    : '';

                item.innerHTML = `
                    ${imgHtml}
                    <div class="news-content">
                        <h3>${applyHardSpaces(post.title || 'News')}</h3>
                        <p class="news-date">${dateText}</p>
                        <p class="news-body text-unified">${shortBody}</p>
                        ${linkButton}
                    </div>
                `;

                container.appendChild(item);
            });
        } catch (e) {
            console.error('BÅ‚Ä…d pobierania z Facebooka:', e);
        }
    }

    window.addEventListener('DOMContentLoaded', loadFacebookNews);
    </script>

    <!--
-->
<script>
  function showDonationInfo() {
    const status = document.getElementById('donationStatus');
    if (!status) return;
    // Re-announce message for screen readers
    status.textContent = status.textContent;
    status.classList.remove('visually-hidden');
    // Hide again after a moment for visual users (message is not needed visually)
    window.setTimeout(() => status.classList.add('visually-hidden'), 3000);
  }
</script>


<div id="donationToast"
     class="toast is-hidden"
     role="status"
     aria-live="polite"
     aria-atomic="true">
  <div class="toast__content" id="donationToastText"></div>
  <button type="button"
          class="toast__close"
          aria-label="Close message"
          onclick="hideDonationToast()">Ã—</button>
</div>

<script>
  let toastTimer = null;

  function showDonationInfo() {
    const status = document.getElementById('donationStatus');
    const toast = document.getElementById('donationToast');
    const text  = document.getElementById('donationToastText');
    if (!status || !toast || !text) return;

    const msg = status.textContent.trim();

    text.textContent = msg;
    toast.classList.remove('is-hidden');

    clearTimeout(toastTimer);
    toastTimer = setTimeout(hideDonationToast, 8000);

    status.textContent = '';
    setTimeout(() => status.textContent = msg, 20);
  }

  function hideDonationToast() {
    const toast = document.getElementById('donationToast');
    if (!toast) return;
    toast.classList.add('is-hidden');
    clearTimeout(toastTimer);
    toastTimer = null;
  }
</script>


    <button id="scrollToTop" aria-label="Back to top" type="button">
      <svg class="to-top-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M12 5l-7 7m7-7l7 7M12 5v14" fill="none" stroke="currentColor" stroke-width="3.2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <script>
      (function() {
        const scrollBtn = document.getElementById('scrollToTop');
        if (!scrollBtn) return;

        function reduceMotion() {
          return window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        }

        function updateVisibility() {
          scrollBtn.classList.toggle('is-visible', window.scrollY > 400);
        }

        window.addEventListener('scroll', updateVisibility, { passive: true });
        updateVisibility();

        let pending = false;

        function goTopNow(e) {
          if (pending) return;
          pending = true;

          if (e && typeof e.preventDefault === 'function') e.preventDefault();

          const behavior = reduceMotion() ? 'auto' : 'smooth';

          // Help cancel momentum scrolling first
          window.scrollTo({ top: window.scrollY, behavior: 'auto' });

          // Start new scroll on next frames (works better on iOS/Android during momentum)
          requestAnimationFrame(() => {
            requestAnimationFrame(() => {
              window.scrollTo({ top: 0, behavior });
              setTimeout(() => { pending = false; }, 250);
            });
          });
        }

        // Trigger before click so first tap works during momentum
        scrollBtn.addEventListener('pointerdown', goTopNow, { passive: false });
        scrollBtn.addEventListener('touchstart', goTopNow, { passive: false });
        scrollBtn.addEventListener('click', goTopNow);
      })();
    </script>


  <!-- Recording modal -->
  <div class="recording-modal" id="recording-modal" aria-hidden="true" role="dialog" aria-modal="true">
    <button class="recording-modal__overlay" type="button" aria-label="Close"></button>
    <div class="recording-modal__content" role="document">
      <button class="recording-modal__close" type="button" aria-label="Close">Ã—</button>
      <iframe id="recording-modal-iframe" title="Recording player" loading="lazy" allow="autoplay; encrypted-media; fullscreen; picture-in-picture"></iframe>
    </div>
  </div>


<script>
/* Recording modal for ffm.to (static HTML on Vercel) */
(function () {
  const modal = document.getElementById("recording-modal");
  const iframe = document.getElementById("recording-modal-iframe");
  if (!modal || !iframe) return;

  const overlayBtn = modal.querySelector(".recording-modal__overlay");
  const closeBtn = modal.querySelector(".recording-modal__close");

  let lastActiveEl = null;
  let prevBodyOverflow = "";

  function openModal(url) {
    if (!url) return;

    lastActiveEl = document.activeElement;
    prevBodyOverflow = document.body.style.overflow;

    modal.classList.add("is-open");
    modal.setAttribute("aria-hidden", "false");
    document.body.style.overflow = "hidden";

    iframe.src = url;

    if (closeBtn && typeof closeBtn.focus === "function") closeBtn.focus();
  }

  function closeModal() {
    modal.classList.remove("is-open");
    modal.setAttribute("aria-hidden", "true");

    iframe.src = "about:blank";
    document.body.style.overflow = prevBodyOverflow || "";

    if (lastActiveEl && typeof lastActiveEl.focus === "function") lastActiveEl.focus();
  }

  document.addEventListener("click", (e) => {
    const target = e.target && e.target.closest ? e.target.closest(".open-recording-modal") : null;
    if (!target) return;

    const url = target.getAttribute("data-modal-url") || target.getAttribute("href");
    if (!url) return;

    e.preventDefault();
    openModal(url);
  });

  if (overlayBtn) overlayBtn.addEventListener("click", closeModal);
  if (closeBtn) closeBtn.addEventListener("click", closeModal);

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && modal.classList.contains("is-open")) closeModal();
  });
})();
</script>

</body>
</html>
